<h1>Quiz</h1>

<?php if (isset($error)): ?>
    <p style="color: red;"><?= $error ?></p>
<?php endif; ?>

<!-- Debug: question_id = <?= $_POST['question_id'] ?? 'none' ?>, answer = <?= $_POST['answer'] ?? 'none' ?> -->

<?php if (isset($result)): ?>

    <h2><?= htmlspecialchars($result['name']) ?></h2>
    <p><?= htmlspecialchars($result['description']) ?></p>

    <?php if ($result['image']): ?>
        <img src="./assets/images/games/<?= htmlspecialchars($result['image']) ?>" alt="<?= htmlspecialchars($result['name']) ?>">
    <?php endif; ?>

    <form method="POST">
        <button type="submit">Rejouer</button>
    </form>

<?php elseif (isset($question)): ?>

    <img id="akinatorImg" src="./assets/images/akinator/akinator_1.png" alt="Akinator" style="width: 200px; margin-bottom: 20px;">
    <p><?= htmlspecialchars($question['question']) ?></p>

    <form method="POST" id="quizForm">
        <input type="hidden" name="question_id" value="<?= $question['id'] ?>">
        <button type="submit" name="answer" value="Oui">Oui</button>
        <button type="submit" name="answer" value="Non">Non</button>
    </form>

    <script>
        const images = ['akinator.png', 'akinator_1.png', 'akinator_2.png', 'akinator_3.png'];
        const quizForm = document.getElementById('quizForm');
        const akinatorImg = document.getElementById('akinatorImg');

        function getRandomImage() {
            return images[Math.floor(Math.random() * images.length)];
        }

        quizForm.addEventListener('submit', function () {
            const newImage = getRandomImage();
            akinatorImg.src = `./assets/images/akinator/${newImage}`;
        });

        // Définir une image aléatoire au chargement initial
        akinatorImg.src = `./assets/images/akinator/${getRandomImage()}`;
    </script>
<?php else: ?>
    <p>Aucune question disponible.</p>
<?php endif; ?>